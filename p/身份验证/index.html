<!DOCTYPE html>
<html lang="zh-cn">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='发送邮件与手机验证码'><title>身份验证</title>

<link rel='canonical' href='https://uggmycar.github.io/p/%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='身份验证'>
<meta property='og:description' content='发送邮件与手机验证码'>
<meta property='og:url' content='https://uggmycar.github.io/p/%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81/'>
<meta property='og:site_name' content='示例站点'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2021-08-16T16:16:26&#43;08:00'/><meta property='article:modified_time' content='2021-08-16T16:16:26&#43;08:00'/><meta property='og:image' content='https://uggmycar.github.io/p/%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81/a.jpg' />
<meta name="twitter:site" content="@棉花糖">
    <meta name="twitter:creator" content="@棉花糖"><meta name="twitter:title" content="身份验证">
<meta name="twitter:description" content="发送邮件与手机验证码"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://uggmycar.github.io/p/%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81/a.jpg' />
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="https://uggmycar.github.io/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>返回</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81/">
                <img src="/p/%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81/a_hu700275244aab45103b63a9bdebf71928_5794243_800x0_resize_q75_box.jpg"
                        srcset="/p/%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81/a_hu700275244aab45103b63a9bdebf71928_5794243_800x0_resize_q75_box.jpg 800w, /p/%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81/a_hu700275244aab45103b63a9bdebf71928_5794243_1600x0_resize_q75_box.jpg 1600w"
                        width="800" 
                        height="800" 
                        loading="lazy"
                        alt="Featured image of post 身份验证" />
                
            </a>
        </div>
    

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="/p/%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81/">身份验证</a>
    </h2>

    
    <h3 class="article-subtitle">
        发送邮件与手机验证码
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Aug 16, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    3 min read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="font-face宋体-colorbrown前言font"><font face="宋体" color=brown>前言</font></h2>
<table>
<thead>
<tr>
<th>邮件类型</th>
<th>特点</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><a class="link" href="#1.3" >简单邮件</a></td>
<td>不能解析html语言，发送的为原本文本，不能加附件发送</td>
<td></td>
</tr>
<tr>
<td><a class="link" href="#1.4" >复杂邮件</a></td>
<td>可以选择是否解析html语言，能加附件发送</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="font-face宋体-colorpurple依赖font"><font face="宋体" color=purple>依赖</font></h2>
<p><font face="黑体" color=red>邮件配置的</font><br>
<img src="p.png"  height="300" width="300" ><br>
<img src="pp.png"  height="300" width="300"><br>
<font face="黑体" color=red>手机短信的</font><br>
<img src="ppp.png"  height="300" width="300"></p>
<h2 id="font-face宋体-colororange目录font"><font face="宋体" color=orange>目录</font></h2>
<ul>
<li><a class="link" href="#1" >1.发送邮件</a>
<ul>
<li><a class="link" href="#1.1" >1.1申请邮件授权码（这里是qq的）</a></li>
<li><a class="link" href="#1.2" >1.2applicaton配置</a></li>
<li><a class="link" href="#1.3" >1.3简单邮件发送</a></li>
<li><a class="link" href="#1.4" >1.4复杂邮件发送</a></li>
<li><a class="link" href="#1.5" >1.5发送邮件自定义模板</a>
<ul>
<li><a class="link" href="#1.5.1" >1.5.1使用模板的注意事项</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="link" href="#2" >2.手机验证码</a>
<ul>
<li><a class="link" href="#2.1" >2.1初始化</a></li>
<li><a class="link" href="#2.2" >2.2配置</a></li>
<li><a class="link" href="#2.3" >2.3设置http超时与id和Secret</a></li>
<li><a class="link" href="#2.4" >2.4固定部分</a></li>
<li><a class="link" href="#2.5" >2.5填发送对象手机号短信签名与短信模板</a></li>
<li><a class="link" href="#2.6" >2.6用json形的字符串改短信模板中的参数</a></li>
</ul>
</li>
</ul>
<h1 id="font-face黑体-colorgreen-id1发送邮件font"><font face="黑体" color=green id="1">发送邮件</font></h1>
<p><font face="STCAIYUN" color=blue id="1.1">申请邮件授权码（这里是qq的）</font><br>
<img src="33.png"  height="550" width="550" ></p>
<p><font face="STCAIYUN" color=blue id="1.2">applicaton配置</font></p>
<p><font face="黑体" color=red>1.qq邮箱的配置</font><br>
<img src="11.png"  height="550" width="550"><br>
<font face="黑体" color=red>2.163邮箱的配置</font><br>
<img src="22.png"  height="550" width="550"><br>
<font face="黑体" color=red>其它邮箱的配置只要改对应的host那些就行</font></p>
<p><font face="STCAIYUN" color=blue id="1.3">简单邮件发送</font></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">  <span style="color:#a6e22e">@Autowired</span>
    JavaMailSenderImpl MailSender<span style="color:#f92672">;</span>
 <span style="color:#a6e22e">@Test</span>
    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">contextLoads</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">//建简单邮件对象
</span><span style="color:#75715e"></span>        SimpleMailMessage MailMessage <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SimpleMailMessage<span style="color:#f92672">();</span>
        <span style="color:#75715e">//邮件设置
</span><span style="color:#75715e"></span>        MailMessage<span style="color:#f92672">.</span><span style="color:#a6e22e">setSubject</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;我是邮件标题-来了&#34;</span><span style="color:#f92672">);</span>  <span style="color:#75715e">//标题
</span><span style="color:#75715e"></span>        MailMessage<span style="color:#f92672">.</span><span style="color:#a6e22e">setText</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;我是邮件内容-来了&#34;</span><span style="color:#f92672">);</span>        <span style="color:#75715e">//邮件内容
</span><span style="color:#75715e"></span>        MailMessage<span style="color:#f92672">.</span><span style="color:#a6e22e">setTo</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;接受者qq@qq.com&#34;</span><span style="color:#f92672">);</span>  <span style="color:#75715e">//发给谁
</span><span style="color:#75715e"></span>        MailMessage<span style="color:#f92672">.</span><span style="color:#a6e22e">setFrom</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;发送者qq@qq.com&#34;</span><span style="color:#f92672">);</span><span style="color:#75715e">//谁发的
</span><span style="color:#75715e"></span>        MailSender<span style="color:#f92672">.</span><span style="color:#a6e22e">send</span><span style="color:#f92672">(</span>MailMessage<span style="color:#f92672">);</span>

    <span style="color:#f92672">}</span>
</code></pre></div><p><font face="STCAIYUN" color=blue id="1.4">复杂邮件发送</font></p>
<p><font face="黑体" color=red>1.这部分用的是模板可看<a class="link" href="#1.5" >发送邮件自定义模板</a></font></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">  <span style="color:#a6e22e">@Autowired</span>
    JavaMailSenderImpl MailSender<span style="color:#f92672">;</span>

    <span style="color:#75715e">//thymeleaf解析器
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">@Autowired</span>
    <span style="color:#66d9ef">private</span> TemplateEngine templateEngine<span style="color:#f92672">;</span>

<span style="color:#a6e22e">@Test</span>
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendMail</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> MessagingException <span style="color:#f92672">{</span>
	<span style="color:#75715e">//是可自定义对象
</span><span style="color:#75715e"></span>    Message message <span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> Message<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ai&#34;</span><span style="color:#f92672">,</span>11<span style="color:#f92672">);</span>
    <span style="color:#75715e">//创建邮件正文
</span><span style="color:#75715e"></span>    Context context <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Context<span style="color:#f92672">();</span>
    <span style="color:#75715e">//设置邮件模板内可变参数（message是一个对象）
</span><span style="color:#75715e"></span>    context<span style="color:#f92672">.</span><span style="color:#a6e22e">setVariable</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;message&#34;</span><span style="color:#f92672">,</span> message<span style="color:#f92672">);</span>
    <span style="color:#75715e">//替换字符串
</span><span style="color:#75715e"></span>    String content <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http&#34;</span><span style="color:#f92672">;</span>
    String replace <span style="color:#f92672">=</span> content<span style="color:#f92672">.</span><span style="color:#a6e22e">replace</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;http&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;https://xxx/1.png&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#75715e">//放入context
</span><span style="color:#75715e"></span>    context<span style="color:#f92672">.</span><span style="color:#a6e22e">setVariable</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;image&#34;</span><span style="color:#f92672">,</span> replace<span style="color:#f92672">);</span>
    context<span style="color:#f92672">.</span><span style="color:#a6e22e">setVariable</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;sendTime&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">());</span>
    <span style="color:#75715e">//用于解析模板并利用当前response对象的writer把模板输出到浏览器(返回值是html文件包括变量的)
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//用带参数的context改变a.html（用thymeleaf语法）返回的是改变了的html
</span><span style="color:#75715e"></span>    String emailContent <span style="color:#f92672">=</span> templateEngine<span style="color:#f92672">.</span><span style="color:#a6e22e">process</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> context<span style="color:#f92672">);</span>

</code></pre></div><p><font face="黑体" color=red>2.用MailSender.createMimeMessage()，创建复杂邮件对象&ndash;与简单邮件不同处</font></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    <span style="color:#75715e">//建复杂邮件对象
</span><span style="color:#75715e"></span>    MimeMessage mimeMessage <span style="color:#f92672">=</span>MailSender<span style="color:#f92672">.</span><span style="color:#a6e22e">createMimeMessage</span><span style="color:#f92672">();</span>
    <span style="color:#75715e">//true表示需要创建一个multipart message
</span><span style="color:#75715e"></span>    MimeMessageHelper helpr<span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> MimeMessageHelper<span style="color:#f92672">(</span>mimeMessage<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>
    <span style="color:#75715e">//邮件设置
</span><span style="color:#75715e"></span>    helpr<span style="color:#f92672">.</span><span style="color:#a6e22e">setSubject</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;我是邮件标题-来了&#34;</span><span style="color:#f92672">);</span>
</code></pre></div><p><font face="黑体" color=red>3.这里可以选是否解析html代码</font></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    helpr<span style="color:#f92672">.</span><span style="color:#a6e22e">setText</span><span style="color:#f92672">(</span>emailContent<span style="color:#f92672">,</span><span style="color:#66d9ef">true</span><span style="color:#f92672">);</span>   <span style="color:#75715e">//设置其为会解析html
</span><span style="color:#75715e"></span>    helpr<span style="color:#f92672">.</span><span style="color:#a6e22e">setTo</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;接受者qq@qq.com&#34;</span><span style="color:#f92672">);</span>  <span style="color:#75715e">//发给谁
</span><span style="color:#75715e"></span>    helpr<span style="color:#f92672">.</span><span style="color:#a6e22e">setFrom</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;发送者qq@qq.com&#34;</span><span style="color:#f92672">);</span><span style="color:#75715e">//谁发的
</span><span style="color:#75715e"></span>
    <span style="color:#75715e">//上传文件
</span><span style="color:#75715e"></span>    helpr<span style="color:#f92672">.</span><span style="color:#a6e22e">addAttachment</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;1.png&#34;</span><span style="color:#f92672">,</span><span style="color:#66d9ef">new</span> File<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;C:\\Users\\12113\\Desktop\\1.png&#34;</span><span style="color:#f92672">));</span>

    MailSender<span style="color:#f92672">.</span><span style="color:#a6e22e">send</span><span style="color:#f92672">(</span>mimeMessage<span style="color:#f92672">);</span>

<span style="color:#f92672">}</span>


</code></pre></div><p><font face="STCAIYUN" color=blue id="1.5">发送邮件自定义模板</font><br>
<font face="黑体" color=red>1.先用thymeleaf的Context容器放入参数</font></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">  <span style="color:#a6e22e">@Autowired</span>
    JavaMailSenderImpl MailSender<span style="color:#f92672">;</span>

    <span style="color:#75715e">//thymeleaf解析器
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">@Autowired</span>
    <span style="color:#66d9ef">private</span> TemplateEngine templateEngine<span style="color:#f92672">;</span>

<span style="color:#a6e22e">@Test</span>
<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SendMail</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> MessagingException <span style="color:#f92672">{</span>
	<span style="color:#75715e">//是可自定义对象
</span><span style="color:#75715e"></span>    Message message <span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> Message<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ai&#34;</span><span style="color:#f92672">,</span>11<span style="color:#f92672">);</span>
    <span style="color:#75715e">//创建邮件正文
</span><span style="color:#75715e"></span>    Context context <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Context<span style="color:#f92672">();</span>
    <span style="color:#75715e">//设置邮件模板内可变参数（message是一个对象）
</span><span style="color:#75715e"></span>    context<span style="color:#f92672">.</span><span style="color:#a6e22e">setVariable</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;message&#34;</span><span style="color:#f92672">,</span> message<span style="color:#f92672">);</span>
    <span style="color:#75715e">//替换字符串
</span><span style="color:#75715e"></span>    String content <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http&#34;</span><span style="color:#f92672">;</span>
    String replace <span style="color:#f92672">=</span> content<span style="color:#f92672">.</span><span style="color:#a6e22e">replace</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;http&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;https://xxx/6.png&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#75715e">//放入context
</span><span style="color:#75715e"></span>    context<span style="color:#f92672">.</span><span style="color:#a6e22e">setVariable</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;image&#34;</span><span style="color:#f92672">,</span> replace<span style="color:#f92672">);</span>
    context<span style="color:#f92672">.</span><span style="color:#a6e22e">setVariable</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;sendTime&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">());</span>
    
</code></pre></div><p><font face="黑体" color=red>1.在将Context放入TemplateEngine引擎里，这里的返回值是接收了参数的a.html的字符串</font></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">//用于解析模板并利用当前response对象的writer把模板输出到浏览器(返回值是html文件包括变量的)
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//用带参数的context改变a.html（用thymeleaf语法）返回的是改变了的html
</span><span style="color:#75715e"></span>    String emailContent <span style="color:#f92672">=</span> templateEngine<span style="color:#f92672">.</span><span style="color:#a6e22e">process</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">,</span> context<span style="color:#f92672">);</span>

</code></pre></div><p><font face="黑体" color=red>注意：这里要个a.html在templates有才能访问到</font></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;zh&#34;</span> <span style="color:#a6e22e">xmlns:th</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://www.thymeleaf.org&#34;</span>&gt;
&lt;<span style="color:#f92672">head</span>&gt;
    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
    &lt;<span style="color:#f92672">title</span>&gt;Title&lt;/<span style="color:#f92672">title</span>&gt;

&lt;/<span style="color:#f92672">head</span>&gt;
&lt;<span style="color:#f92672">body</span>&gt;
&lt;<span style="color:#f92672">h</span>&gt;你好，[[${message.name}]],您今年[[${message.age}]]&lt;/<span style="color:#f92672">h</span>&gt;
&lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;avatar1&#34;</span> <span style="color:#a6e22e">width</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;80&#34;</span> <span style="color:#a6e22e">height</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;80&#34;</span> <span style="color:#a6e22e">th:src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;@{${image}}&#34;</span> &gt;
现在时间：&lt;<span style="color:#f92672">th</span> <span style="color:#a6e22e">th:text</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;${sendTime}&#34;</span>&gt;&lt;/<span style="color:#f92672">th</span>&gt;
&lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;
</code></pre></div><h2 id="font-facestcaiyun-colorred--id151使用模板的注意事项font"><font face="STCAIYUN" color=red  id="1.5.1">使用模板的注意事项</font></h2>
<p><font face="黑体" color=red>1.在类里自动注入TemplateEngine，这个类也应是自动注入的（如下）</font><br>
<img src="cw.png"  height="400" width="400" ><font face="黑体" color=red>这个是config层的</font><br>
<img src="cww.png"  height="900" width="900" ><font face="黑体" color=red>这个是controller层的</font></p>
<h1 id="font-face黑体-colorgreen-id2手机验证码font"><font face="黑体" color=green id="2">手机验证码</font></h1>
<p><font face="STCAIYUN" color=blue id="2.1">初始化</font></p>
<p><font face="黑体" color=red>1.先去阿里云申请（要登入），<a class="link" href="https://cn.aliyun.com/"  target="_blank" rel="noopener"
    >点这里跳转</a></font><br>
<img src="1.png"  height="900" width="900" ><br>
<font face="黑体" color=red>2.点击</font><br>
<img src="2.png"  height="900" width="900" ><br>
<font face="黑体" color=red>3.创建并记下AccesKey ID和AccessKeySecret</font><br>
<img src="3.png"  height="900" width="900" ><br>
<font face="黑体" color=red>4.在XX管理那里，添加签名和添加模板，记住签名与模板名称</font><br>
<img src="4.png"  height="900" width="900" ><br>
<img src="5.png"  height="900" width="900" ></p>
<p><font face="STCAIYUN" color=blue id="2.2">配置</font><br>
<font face="黑体" color=red>1.需要用到的application.yml有这4个</font></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml"><span style="color:#75715e">#手机短信相关配置</span>
<span style="color:#f92672">sms</span>:
  <span style="color:#f92672">accessKeyId</span>: <span style="color:#ae81ff">LTAI4Fku38EbzFCDdL9Sy6RD</span>
  <span style="color:#f92672">accessKeySecret</span>: <span style="color:#ae81ff">XXXXXXXXXXXXXXXX</span>
  <span style="color:#f92672">signName</span>: <span style="color:#ae81ff">X博客</span> <span style="color:#75715e"># 签名名称</span>
  <span style="color:#f92672">verifyCodeTemplate</span>: <span style="color:#ae81ff">SMS_183195163</span> <span style="color:#75715e"># 模板名称</span>
</code></pre></div><p><font face="STCAIYUN" color=blue id="2.3">设置http超时与id和Secret</font><br>
<font face="黑体" color=red>1.System.setProperty的这两个参数在第一次连接时设置，并且会被缓存，在程序不关的情况下，再次访问，还是以第一次的结果为准</font></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">//产品名称:云通信短信API产品,开发者无需替换
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String product <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Dysmsapi&#34;</span><span style="color:#f92672">;</span>
    <span style="color:#75715e">//产品域名,开发者无需替换
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String domain <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dysmsapi.aliyuncs.com&#34;</span><span style="color:#f92672">;</span>
<span style="color:#a6e22e">@Test</span>
    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">sms</span><span style="color:#f92672">()</span><span style="color:#66d9ef">throws</span> ClientException<span style="color:#f92672">{</span>
    <span style="color:#75715e">//可自助调整超时时间-设置http的超时
</span><span style="color:#75715e"></span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">setProperty</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;sun.net.client.defaultConnectTimeout&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;10000&#34;</span><span style="color:#f92672">);</span>
    System<span style="color:#f92672">.</span><span style="color:#a6e22e">setProperty</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;sun.net.client.defaultReadTimeout&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;10000&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#75715e">//初始化acsClient,暂不支持region化
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//keyId和keySecret
</span><span style="color:#75715e"></span>    IClientProfile profile <span style="color:#f92672">=</span> DefaultProfile<span style="color:#f92672">.</span><span style="color:#a6e22e">getProfile</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;cn-hangzhou&#34;</span><span style="color:#f92672">,</span>
            <span style="color:#e6db74">&#34;你自己的AccessKeyId&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;你自己的AccessKeySecret&#34;</span><span style="color:#f92672">);</span>
</code></pre></div><p><font face="STCAIYUN" color=blue id="2.4">固定部分</font></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    <span style="color:#75715e">//product = &#34;Dysmsapi&#34;,domain = &#34;dysmsapi.aliyuncs.com&#34;
</span><span style="color:#75715e"></span>    DefaultProfile<span style="color:#f92672">.</span><span style="color:#a6e22e">addEndpoint</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;cn-hangzhou&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;cn-hangzhou&#34;</span><span style="color:#f92672">,</span> product<span style="color:#f92672">,</span> domain<span style="color:#f92672">);</span>
    <span style="color:#75715e">//放入IClientProfile
</span><span style="color:#75715e"></span>    IAcsClient acsClient <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> DefaultAcsClient<span style="color:#f92672">(</span>profile<span style="color:#f92672">);</span>
</code></pre></div><p><font face="STCAIYUN" color=blue id="2.5">填发送对象手机号短信签名与短信模板</font></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    <span style="color:#75715e">//组装请求对象-具体描述见控制台-文档部分内容
</span><span style="color:#75715e"></span>    SendSmsRequest request <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SendSmsRequest<span style="color:#f92672">();</span>
    request<span style="color:#f92672">.</span><span style="color:#a6e22e">setMethod</span><span style="color:#f92672">(</span>MethodType<span style="color:#f92672">.</span><span style="color:#a6e22e">POST</span><span style="color:#f92672">);</span>
    <span style="color:#75715e">//必填:待发送手机号
</span><span style="color:#75715e"></span>    request<span style="color:#f92672">.</span><span style="color:#a6e22e">setPhoneNumbers</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;发送对象手机号&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#75715e">//必填:短信签名-在application
</span><span style="color:#75715e"></span>    request<span style="color:#f92672">.</span><span style="color:#a6e22e">setSignName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;自己的短信签名&#34;</span><span style="color:#f92672">);</span>
    <span style="color:#75715e">//必填:短信模板-在application
</span><span style="color:#75715e"></span>    request<span style="color:#f92672">.</span><span style="color:#a6e22e">setTemplateCode</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;自己的短信模板&#34;</span><span style="color:#f92672">);</span>
</code></pre></div><p><font face="STCAIYUN" color=blue id="2.6">用json形的字符串改短信模板中的参数</font></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">
    <span style="color:#75715e">//可选:模板中的变量替换JSON串,如模板内容为&#34;亲爱的${name},您的验证码为:${code}&#34;时,此处的值为
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//这里的模板是{&#34;code&#34;:&#34;2333&#34;}  是json写法会加载到自定义里的${code}
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//亲爱的${name},您的验证码为2333
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//todo ：手机模板写法
</span><span style="color:#75715e"></span>    request<span style="color:#f92672">.</span><span style="color:#a6e22e">setTemplateParam</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;{\&#34;code\&#34;:\&#34;&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;2333&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;\&#34;}&#34;</span><span style="color:#f92672">);</span>

    <span style="color:#75715e">//选填-上行短信扩展码(无特殊需求用户请忽略此字段)
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//request.setSmsUpExtendCode(&#34;90997&#34;);
</span><span style="color:#75715e"></span>
    <span style="color:#75715e">//可选:outId为提供给业务方扩展字段,最终在短信回执消息中将此值带回给调用者
</span><span style="color:#75715e"></span>    request<span style="color:#f92672">.</span><span style="color:#a6e22e">setOutId</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;123456&#34;</span><span style="color:#f92672">);</span>

    <span style="color:#75715e">//hint 此处可能会抛出异常，注意catch(成功返回值可取sendSmsResponse.getCode()短信状态，sendSmsResponse.getMessage()短信消息)
</span><span style="color:#75715e"></span>    SendSmsResponse sendSmsResponse <span style="color:#f92672">=</span> acsClient<span style="color:#f92672">.</span><span style="color:#a6e22e">getAcsResponse</span><span style="color:#f92672">(</span>request<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><style>
    .arrow{
        border: 9px solid transparent;
        border-bottom-color: #3DA0DB;
        width: 0px;
        height: 0px;
        top:0px}
    .stick{
        width: 8px;
        height: 14px;
        border-radius: 1px;
        background-color: #3DA0DB;
        top:15px;}
    #back_top div{
        position: absolute;
        margin: auto;
        right: 0px;
        left: 0px;}
    #back_top{
        background-color: #dddddd;
        height: 38px;
        width: 38px;
        border-radius: 3px;
        display: block;
        cursor: pointer;
        position: fixed;
        right: 50px;
        bottom: 100px;
        display: none;}
</style>
<div id="article"></div>
<div id="back_top">
<div class="arrow"></div>
<div class="stick"></div>
</div>
<script src="http://cdn.staticfile.org/jquery/1.11.1-rc2/jquery.min.js"></script>
<script>
$(function(){
$(window).scroll(function(){  //只要窗口滚动,就触发下面代码
var scrollt = document.documentElement.scrollTop + document.body.scrollTop; //获取滚动后的高度
if( scrollt >200 ){  //判断滚动后高度超过200px,就显示
$("#back_top").fadeIn(400); //淡入
}else{
$("#back_top").stop().fadeOut(400); //如果返回或者没有超过,就淡出.必须加上stop()停止之前动画,否则会出现闪动
}});
$("#back_top").click(function(){ //当点击标签的时候,使用animate在200毫秒的时间内,滚到顶部
$("html,body").animate({scrollTop:"0px"},200);
 }); 
});
</script>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript">
var a_idx = 0;
jQuery(document).ready(function($) {
    $("body").click(function(e) {
        var a = new Array("❤哎嘿❤","❤哦豁❤","❤呀~❤","❤嗯？❤","❤点击❤","❤芜湖❤","❤滴❤","❤别点啦❤","❤没东西啦❤","❤瞎点~❤","❤我在哟❤","❤好看不❤");
        var $i = $("<span></span>").text(a[a_idx]);
        a_idx = (a_idx + 1) % a.length;
        var x = e.pageX,
        y = e.pageY;
        $i.css({
            "z-index": 999999999999999999999999999999999999999999999999999999999999999999999,
            "top": y - 20,
            "left": x,
            "position": "absolute",
            "font-weight": "bold",
            "color": "rgb("+~~(255*Math.random())+","+~~(255*Math.random())+","+~~(255*Math.random())+")"
        });
        $("body").append($i);
        $i.animate({
            "top": y - 180,
            "opacity": 0
        },
        1500,
        function() {
            $i.remove();
        });
    });
});
</script>
<style type=text/css>
body { cursor:url('sb.png'), pointer}		//在body内的元素会变  
</style><blockquote>
</blockquote>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
</aside>

     
     
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2021 示例站点
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="2.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>

    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">目录</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#font-face宋体-colorbrown前言font"><font face="宋体" color=brown>前言</font></a></li>
    <li><a href="#font-face宋体-colorpurple依赖font"><font face="宋体" color=purple>依赖</font></a></li>
    <li><a href="#font-face宋体-colororange目录font"><font face="宋体" color=orange>目录</font></a></li>
  </ul>

  <ul>
    <li><a href="#font-facestcaiyun-colorred--id151使用模板的注意事项font"><font face="STCAIYUN" color=red  id="1.5.1">使用模板的注意事项</font></a></li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
